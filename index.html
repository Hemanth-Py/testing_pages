<html>
<head>
  <title>Camera and File Upload</title>
</head>
<body>
  <div>
    <h1>Take Picture:</h1>
    <video id="video" width="640" height="480" autoplay></video>
    <br>
    <button id="capture" onclick="captureImage()">Capture</button>
  </div>
  <br>
  <div>
    <h1>Choose File:</h1>
    <input type="file" id="fileInput" multiple onchange="uploadFiles()"/>
  </div>
  <!-- <br>
  <div>
    <h1>Drag and Drop:</h1>
    <div id="dropArea">Drop files here</div>
  </div> -->
  <script>
    const video = document.getElementById('video');
    const captureButton = document.getElementById('capture');
    const canvas = document.createElement('canvas');

    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
      });

    const captureImage = () => {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      canvas.getContext('2d').drawImage(video, 0, 0);
      const imgUrl = canvas.toDataURL();
      sendImageToAPI(imgUrl);
    }

    const uploadFiles = () => {
      const files = document.getElementById('fileInput').files;
      for (let i = 0; i < files.length; i++) {
        const file = files[i];
        const reader = new FileReader();
        reader.onload = (e) => {
          const imgUrl = e.target.result;
          sendImageToAPI(imgUrl);
        }
        reader.readAsDataURL(file);
      }
    };

function sendImageToAPI(imgUrl) {
  const apiUrl = 'https://zv5qlffuqc.execute-api.us-east-1.amazonaws.com/dev/upload_face_img';
  const data = {
    image: imgUrl,
    file_name: 'hemanth.jpg',
  };
  console.log(data)
  fetch(apiUrl, {
    method: 'POST',
    body: JSON.stringify(data),
    headers: {
      'Content-Type': 'application/json',
    },
  })
    .then(response => response.json())
    .then(data => {
      console.log('Success:', data);
    })
    .catch(error => {
      console.error('Error:', error);
    });
}
</script>