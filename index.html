<!-- HTML -->
<video id="video-preview" autoplay muted></video>
<img id="captured-image" />
<button id="capture-button">Capture</button>
<button id="toggle-camera-button">Start/Stop Camera</button>

<script>
  // JavaScript
  var toggleCameraButton = document.getElementById('toggle-camera-button');
  var captureButton = document.getElementById('capture-button');
  var videoPreview = document.getElementById('video-preview');

  toggleCameraButton.addEventListener('click', function() {
    if (videoPreview.srcObject) {
      // Stop the camera
      videoPreview.srcObject.getTracks().forEach(function(track) {
        track.stop();
      });
      videoPreview.srcObject = null;
    } else {
      // Start the camera
      navigator.mediaDevices.getUserMedia({ video: true })
        .then(function(stream) {
          videoPreview.srcObject = stream;
        })
        .catch(function(error) {
          console.error('Error accessing camera:', error);
        });
    }
  });

  captureButton.addEventListener('click', function() {
    // Create a canvas element
    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');

    // Set the size of the canvas to the same size as the camera preview
    canvas.width = videoPreview.videoWidth;
    canvas.height = videoPreview.videoHeight;

    // Draw the current frame of the camera preview on the canvas
    context.drawImage(videoPreview, 0, 0);

    // Get the data URL of the canvas
    var imageDataUrl = canvas.toDataURL();

    // Set the src attribute of the img element to the data URL
    document.getElementById('captured-image').src = imageDataUrl;

    // Send the image data to the API
  fetch('/api/upload-image', {
    method: 'POST',
    body: imageDataUrl
  })
    .then(function(response) {
      console.log('Image uploaded:', response);
    })
    .catch(function(error) {
      console.error('Error uploading image:', error);
    });
  });
</script>
